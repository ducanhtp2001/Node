create database android;

drop table note;
drop table taikhoan;
drop table lichhoc;
drop table dangkimonhoc;
drop table danhsachloptinchi;
drop table danhsachmonhoc;
drop table thongtinsinhvien;


CREATE TABLE thongtinsinhvien (
    id INT PRIMARY KEY AUTO_INCREMENT,
    hoten VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci not null,
    ngaysinh DATE not null,
    gioitinh VARCHAR(5),
    quequan VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci not null,
    gmail VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci,
    sdt VARCHAR(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci,
    khoa INT not null,
    nienkhoa INT not null,
    lop INT not null
);

CREATE TABLE danhsachmonhoc (
    id INT PRIMARY KEY AUTO_INCREMENT,
    soTin INT,
    tenmon VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci
);

CREATE TABLE danhsachloptinchi (
    id INT PRIMARY KEY AUTO_INCREMENT,
    mamon INT,
    loptinchi int,
    tenGiaoVien VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci not null,
    FOREIGN KEY (mamon) REFERENCES danhsachmonhoc(id)
);


CREATE TABLE dangkimonhoc (
    id INT PRIMARY KEY AUTO_INCREMENT,
    idsinhvien INT,
    mamon INT,
    loptinchi INT,
    FOREIGN KEY (idsinhvien) REFERENCES thongtinsinhvien(id),
    FOREIGN KEY (mamon) REFERENCES danhsachmonhoc(id),
    FOREIGN KEY (loptinchi) REFERENCES danhsachloptinchi(id)
);

CREATE TABLE lichhoc (
    id INT PRIMARY KEY AUTO_INCREMENT,
    mamon INT,
    loptinchi INT,
    ngayhoc DATE,
    cahoc INT,
    phonghoc VARCHAR(50),
    FOREIGN KEY (mamon) REFERENCES danhsachmonhoc(id),
    FOREIGN KEY (loptinchi) REFERENCES danhsachloptinchi(id)
);


CREATE TABLE taikhoan (
    id INT PRIMARY KEY AUTO_INCREMENT,
    idsinhvien INT,
    taikhoan VARCHAR(10),
    matkhau VARCHAR(10),
    FOREIGN KEY (idsinhvien) REFERENCES thongtinsinhvien(id)
);

CREATE TABLE note (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    idsinhvien INT,
    tieude VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci,
    ngayTao DATE,
    ngayCapNhat DATE,
    noidung TEXT,
    FOREIGN KEY (idsinhvien) REFERENCES thongtinsinhvien(id)
);






SELECT *
FROM (danhsachmonhoc
JOIN danhsachloptinchi ON danhsachmonhoc.id = danhsachloptinchi.mamon)
JOIN dangkimonhoc on (dangkimonhoc.mamon = danhsachloptinchi.mamon and dangkimonhoc.loptinchi = danhsachloptinchi.loptinchi);

SELECT *
FROM ((danhsachmonhoc
JOIN danhsachloptinchi ON danhsachmonhoc.id = danhsachloptinchi.mamon)
JOIN dangkimonhoc on (dangkimonhoc.mamon = danhsachloptinchi.mamon and dangkimonhoc.loptinchi = danhsachloptinchi.loptinchi)) join lichhoc on (dangkimonhoc.mamon = lichhoc.mamon and dangkimonhoc.loptinchi = lichhoc.loptinchi);

SELECT tenmon, sotin, lichhoc.mamon, lichhoc.loptinchi, tengiaovien, idsinhvien,
ngayhoc, cahoc, phonghoc
FROM ((danhsachmonhoc
JOIN danhsachloptinchi ON danhsachmonhoc.id = danhsachloptinchi.mamon)
JOIN dangkimonhoc on (dangkimonhoc.mamon = danhsachloptinchi.mamon and dangkimonhoc.loptinchi = danhsachloptinchi.loptinchi)) join lichhoc on (dangkimonhoc.mamon = lichhoc.mamon and dangkimonhoc.loptinchi = lichhoc.loptinchi)
ORDER BY lichhoc.ngayhoc;






